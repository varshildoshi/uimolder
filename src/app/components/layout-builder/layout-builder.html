<div class="h-screen flex flex-col bg-[#020617] text-slate-300 font-['Tomorrow']" cdkDropListGroup
  [ngStyle]="{ 'padding-top': headerHeight() + 'px' }">

  <header class="h-16 border-b border-white/5 bg-black/40 flex items-center justify-between px-8 shrink-0 relative">
    <!-- Left Placeholder for centering -->
    <div class="w-48 hidden md:block"></div>

    <!-- Centered Flavor Selector (Only in Editor) -->
    @if (viewMode() === 'editor') {
    <div
      class="flex items-center gap-4 px-4 py-2 rounded-xl border border-white/10 bg-white/[0.05] backdrop-blur-xl animate-in fade-in duration-300">
      @for (flavor of flavors; track flavor.name) {
      <button (click)="activeFlavor.set(flavor.name)"
        class="flex items-center gap-2 text-sm font-medium transition-all px-3 py-1 rounded-lg" [ngClass]="{
                  'bg-white/10 backdrop-blur-md': activeFlavor() === flavor.name
              }">
        <svg width="20" height="20" viewBox="0 0 24 24">
          <path [attr.fill]="activeFlavor() === flavor.name ? flavor.color : 'rgba(255,255,255,0.5)'"
            [attr.d]="flavor.iconPath" />
        </svg>
        <span [style.color]="activeFlavor() === flavor.name ? flavor.color : 'rgb(148 163 184)'">{{
          flavor.label }}</span>
      </button>
      }
    </div>
    } @else {
    <div
      class="flex items-center gap-2 px-4 py-2 rounded-xl border border-brand-gold/20 bg-brand-gold/5 text-brand-gold font-mono text-[10px] uppercase tracking-[0.2em]">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
        class="icon icon-tabler icons-tabler-outline icon-tabler-eye text-[16px]">
        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
        <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
        <path d="M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6" />
      </svg>
      Live Preview Mode
    </div>
    }

    <!-- Right Side Export -->
    <div class="w-48 flex justify-end">
      <button (click)="exportLayout()"
        class="flex items-center gap-2 btn-primary px-4 py-2 font-semibold text-xs uppercase tracking-tight transition-all shadow-lg">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
          class="icon icon-tabler icons-tabler-outline icon-tabler-download text-[18px]">
          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
          <path d="M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2" />
          <path d="M7 11l5 5l5 -5" />
          <path d="M12 4l0 12" />
        </svg>
        EXPORT LAYOUT
      </button>
    </div>
  </header>

  <div class="flex flex-1 overflow-hidden" cdkDropListGroup>
    <!-- Modular Sidebar Menu -->
    <app-elements-menu class="shrink-0" />

    <!-- Modular Canvas area -->
    <app-elements-canvas class="flex-1 overflow-hidden" [viewMode]="viewMode()" (addRow)="addNewRow()"
      (removeRowAction)="removeRow($event)" (removeItemAction)="removeItem($event)"
      (selectElement)="selectedElementId.set($event)" (viewModeChange)="viewMode.set($event)" />

    <!-- Modular Right Sidebar / Settings -->
    <app-elements-settings class="shrink-0" />
  </div>
</div>