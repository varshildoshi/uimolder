<section
  class="flex-1 bg-[radial-gradient(#ffffff05_1px,transparent_1px)] bg-size[30px_30px] flex flex-col overflow-hidden h-[calc(100vh-150px)] overflow-y-auto">

  <div class="flex-1 p-8 flex flex-col gap-8 scroll-container">

    <!-- Canvas Controls -->
    <div class="sticky top-0 z-20 bg-[#020617]/95 backdrop-blur-md -mx-8 -mt-8 p-8 pb-6 border-b border-white/5">
      <div class="max-w-6xl mx-auto w-full flex items-center justify-between shrink-0">
        <!-- View Toggle (Left) -->
        <div class="flex items-center gap-1 bg-white/5 p-1 rounded-xl border border-white/10 backdrop-blur-md">
          <button (click)="setViewMode('editor')" [class.bg-brand-gold]="viewMode() === 'editor'"
            [class.text-black]="viewMode() === 'editor'"
            class="px-4 py-1.5 rounded-lg text-[12px] font-medium transition-all flex items-center gap-2 tracking-widest">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
              class="icon icon-tabler icons-tabler-outline icon-tabler-geometry text-[16px]">
              <path stroke="none" d="M0 0h24v24H0z" fill="none" />
              <path d="M7 21l4 -12m2 0l1.48 4.439m.949 2.847l1.571 4.714" />
              <path d="M10 7a2 2 0 1 0 4 0a2 2 0 1 0 -4 0" />
              <path d="M4 12c1.526 2.955 4.588 5 8 5c3.41 0 6.473 -2.048 8 -5" />
              <path d="M12 5v-2" />
            </svg>
            EDITOR
          </button>
          <button (click)="setViewMode('preview')" [class.bg-brand-gold]="viewMode() === 'preview'"
            [class.text-black]="viewMode() === 'preview'"
            class="px-4 py-1.5 rounded-lg text-[12px] font-medium transition-all flex items-center gap-2 tracking-widest">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
              class="icon icon-tabler icons-tabler-outline icon-tabler-eye text-[16px]">
              <path stroke="none" d="M0 0h24v24H0z" fill="none" />
              <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
              <path d="M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6" />
            </svg>
            PREVIEW
          </button>
        </div>

        <!-- Add Row Button (Right, Only in Editor) -->
        @if (viewMode() === 'editor') {
        <button (click)="elementService.addRow()"
          class="flex items-center gap-2 btn-primary px-4 py-2 font-semibold text-xs uppercase tracking-tight transition-all shadow-lg">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
            class="icon icon-tabler icons-tabler-outline icon-tabler-plus text-sm">
            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <path d="M12 5l0 14" />
            <path d="M5 12l14 0" />
          </svg>
          Add Row
        </button>
        } @else {
        <!-- Live preview mode -->
        <div
          class="flex items-center gap-2 px-3 py-1.5 w-fit rounded-lg bg-green-500/5 border border-green-500/20 ml-1">
          <div class="relative flex h-2 w-2">
            <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span>
            <span class="relative inline-flex rounded-full h-2 w-2 bg-green-500"></span>
          </div>
          <span class="text-[10px] font-mono text-green-500 uppercase tracking-[0.2em] font-medium">Live Preview
            Mode</span>
        </div>
        }
      </div>
    </div>

    @if (viewMode() === 'editor') {
    <app-element-editor />
    } @else {
    <app-element-preview />
    }
  </div>
</section>